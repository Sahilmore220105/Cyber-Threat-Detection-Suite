import pefile
import pandas as pd

def get_pe_features(file_path):
    """Extracts standard PE header features from a binary file."""
    try:
        pe = pefile.PE(file_path)
        features = {
            'blp': pe.DOS_HEADER.e_cp,  # Placeholder for blp - using e_cp value
            'Fp': len(pe.sections),  # Number of sections as proxy for Fp
            'Rn': pe.FILE_HEADER.NumberOfSections,  # Number of sections
            'mach': pe.FILE_HEADER.Machine,  # Machine type
            'nsec': pe.FILE_HEADER.NumberOfSections,  # Number of sections
            'tds': pe.FILE_HEADER.TimeDateStamp,  # Time/Date stamp
            'codesize': pe.OPTIONAL_HEADER.SizeOfCode,  # Size of code section
            'initdatsize': pe.OPTIONAL_HEADER.SizeOfInitializedData,  # Size of initialized data
            'uninitdatsize': pe.OPTIONAL_HEADER.SizeOfUninitializedData  # Size of uninitialized data
        }
        return pd.DataFrame([features])
    except Exception as e:
        return None